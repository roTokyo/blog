/*! bigfoot.js - v2.1.4  https://github.com/lemonmade/bigfoot */
(function(){var k;(k=jQuery).bigfoot=function(t){var o,e,d,n,s,O,i,a,r,_,l,f,c,u,v,b,C,p,g,T,h,m,y,w,x,F,N;return r={actionOriginalFN:"hide",activateCallback:function(){},activateOnHover:!1,allowMultipleFN:!1,anchorPattern:/(fn|footnote|note)[:\-_\d]/gi,anchorParentTagname:"sup",breakpoints:{},deleteOnUnhover:!1,footnoteParentClass:"footnote",footnoteTagname:"li",hoverDelay:250,numberResetSelector:d=void 0,popoverDeleteDelay:300,popoverCreateDelay:100,positionContent:!0,preventPageScroll:!0,scope:!1,useFootnoteOnlyOnce:!0,contentMarkup:'<aside class="bigfoot-footnote is-positioned-bottom" data-footnote-number="{{FOOTNOTENUM}}" data-footnote-identifier="{{FOOTNOTEID}}" alt="Footnote {{FOOTNOTENUM}}"> <div class="bigfoot-footnote__wrapper"> <div class="bigfoot-footnote__content"> {{FOOTNOTECONTENT}} </div></div> <div class="bigfoot-footnote__tooltip"></div> </aside>',buttonMarkup:'<div class=\'bigfoot-footnote__container\'> <button class="bigfoot-footnote__button" id="{{SUP:data-footnote-backlink-ref}}" data-footnote-number="{{FOOTNOTENUM}}" data-footnote-identifier="{{FOOTNOTEID}}" alt="guarda la nota n\xb0 {{FOOTNOTENUM}}" rel="footnote" data-bigfoot-footnote="{{FOOTNOTECONTENT}}"> <svg class="bigfoot-footnote__button__circle" viewbox="0 0 6 6" preserveAspectRatio="xMinYMin"><circle r="3" cx="3" cy="3" fill="white"></circle></svg> <svg class="bigfoot-footnote__button__circle" viewbox="0 0 6 6" preserveAspectRatio="xMinYMin"><circle r="3" cx="3" cy="3" fill="white"></circle></svg> <svg class="bigfoot-footnote__button__circle" viewbox="0 0 6 6" preserveAspectRatio="xMinYMin"><circle r="3" cx="3" cy="3" fill="white"></circle></svg> </button></div>'},y=k.extend(r,t),v={},f=function(){var t,o,e,n,i,a,r,s,l,f,c,d,u,p,g,h,v,b,m;for(f=y.scope?y.scope+' a[href*="#"]':'a[href*="#"]',e=k(f).filter(function(){var t,o;return"null"!==(o=(t=k(this)).attr("rel"))&&null!=o||(o=""),(""+t.attr("href")+o).match(y.anchorPattern)&&t.closest("[class*="+y.footnoteParentClass+"]:not(a):not("+y.anchorParentTagname+")").length<1}),g=[],s=[],O(e,u=[]),k(u).each(function(){var t,o;if(o=k(this).data("footnote-ref").replace(/[:.+~*\]\[]/g,"\\$&"),y.useFootnoteOnlyOnce&&(o+=":not(.footnote-processed)"),0<(t=k(o).closest(y.footnoteTagname)).length)return g.push(t.first().addClass("footnote-processed")),s.push(this)}),d=(o=k("[data-footnote-identifier]:last")).length<1?0:+o.data("footnote-identifier"),m=[],h=v=0,b=g.length;0<=b?v<b:b<v;h=0<=b?++v:--v)switch(c=(c=C(k(g[h]).html().trim(),k(s[h]).data("footnote-backlink-ref"))).replace(/"/g,"&quot;").replace(/&lt;/g,"&ltsym;").replace(/&gt;/g,"&gtsym;"),d+=1,l="",a=k(s[h]),r=k(g[h]),null!=y.numberResetSelector?((t=a.closest(y.numberResetSelector)).is(n)?p+=1:p=1,n=t):p=d,0!==c.indexOf("<")&&(c="<p>"+c+"</p>"),l=y.buttonMarkup.replace(/\{\{FOOTNOTENUM\}\}/g,p).replace(/\{\{FOOTNOTEID\}\}/g,d).replace(/\{\{FOOTNOTECONTENT\}\}/g,c),l=T(l,"SUP",a),l=T(l,"FN",r),k(l).insertBefore(a),i=r.parent(),y.actionOriginalFN.toLowerCase()){case"hide":a.addClass("footnote-print-only"),r.addClass("footnote-print-only"),m.push(_(i));break;case"delete":a.remove(),r.remove(),m.push(_(i));break;default:m.push(a.addClass("footnote-print-only"))}return m},O=function(t,e){var n,i,a;null==e&&(e=[]),a=i=n=void 0,t.each(function(){var t,o;return o=k(this),i="#"+o.attr("href").split("#")[1],n=o.closest(y.anchorParentTagname),t=o.find(y.anchorParentTagname),0<n.length?(a=(n.attr("id")||"")+(o.attr("id")||""),e.push(n.attr({"data-footnote-backlink-ref":a,"data-footnote-ref":i}))):(a=0<t.length?(t.attr("id")||"")+(o.attr("id")||""):o.attr("id")||"",e.push(o.attr({"data-footnote-backlink-ref":a,"data-footnote-ref":i})))})},_=function(t){var o;return o=void 0,t.is(":empty")||0===t.children(":not(.footnote-print-only)").length?(o=t.parent(),"delete"===y.actionOriginalFN.toLowerCase()?t.remove():t.addClass("footnote-print-only"),_(o)):t.children(":not(.footnote-print-only)").length===t.children("hr:not(.footnote-print-only)").length?(o=t.parent(),"delete"===y.actionOriginalFN.toLowerCase()?t.remove():(t.children("hr").addClass("footnote-print-only"),t.addClass("footnote-print-only")),_(o)):void 0},C=function(t,o){var e;return 0<=o.indexOf(" ")&&(o=o.trim().replace(/\s+/g,"|").replace(/(.*)/g,"($1)")),e=new RegExp("(\\s|&nbsp;)*<\\s*a[^#<]*#"+o+"[^>]*>(.*?)<\\s*/\\s*a>","g"),t.replace(e,"").replace("[]","")},T=function(t,o,e){var n,i,a;for(a=n=void 0,n=(i=new RegExp("\\{\\{"+o+":([^\\}]*)\\}\\}","g")).exec(t);n;)n[1]&&(a=e.attr(n[1])||"",t=t.replace("{{"+o+":"+n[1]+"}}",a)),n=i.exec(t);return t},n=function(t){var o,e;if(y.activateOnHover){if(e='[data-footnote-identifier="'+(o=k(t.target).closest(".bigfoot-footnote__button")).attr("data-footnote-identifier")+'"]',o.hasClass("is-active"))return;o.addClass("is-hover-instantiated"),y.allowMultipleFN||g(".bigfoot-footnote:not("+e+")"),a(".bigfoot-footnote__button"+e).addClass("is-hover-instantiated")}},w=function(t){var o,e,n;o=(n=k(t.target)).closest(".bigfoot-footnote__button"),e=n.closest(".bigfoot-footnote"),0<o.length?(t.preventDefault(),i(o)):e.length<1&&0<k(".bigfoot-footnote").length&&g()},i=function(t){var o;t.blur(),o='data-footnote-identifier="'+t.attr("data-footnote-identifier")+'"',t.hasClass("changing")||(t.hasClass("is-active")?y.allowMultipleFN?g(".bigfoot-footnote["+o+"]"):g():(t.addClass("changing"),setTimeout(function(){return t.removeClass("changing")},y.popoverCreateDelay),a(".bigfoot-footnote__button["+o+"]"),t.addClass("is-click-instantiated"),y.allowMultipleFN||g(".bigfoot-footnote:not(["+o+"])")))},a=function(t){var a,r;return a=void 0,a="string"!=typeof t&&y.allowMultipleFN?t:"string"!=typeof t?t.first():y.allowMultipleFN?k(t).closest(".bigfoot-footnote__button"):k(t+":first").closest(".bigfoot-footnote__button"),r=k(),a.each(function(){var t,o,e,n;e=k(this),n=void 0;try{return n=y.contentMarkup.replace(/\{\{FOOTNOTENUM\}\}/g,e.attr("data-footnote-number")).replace(/\{\{FOOTNOTEID\}\}/g,e.attr("data-footnote-identifier")).replace(/\{\{FOOTNOTECONTENT\}\}/g,e.attr("data-bigfoot-footnote")).replace(/\&gtsym\;/g,"&gt;").replace(/\&ltsym\;/g,"&lt;"),n=T(n,"BUTTON",e)}finally{t=k(n);try{y.activateCallback(t,e)}catch(i){}t.insertAfter(a),v[e.attr("data-footnote-identifier")]="init",t.attr("bigfoot-max-width",s(t.css("max-width"),t)),t.css("max-width",1e4),o=t.find(".bigfoot-footnote__content"),t.attr("data-bigfoot-max-height",s(o.css("max-height"),o)),h(),e.addClass("is-active"),t.find(".bigfoot-footnote__content").bindScrollHandler(),r=r.add(t)}}),setTimeout(function(){return r.addClass("is-active")},y.popoverCreateDelay),r},e=function(){var t,o;return(t=document.createElement("div")).style.cssText="display:inline-block;padding:0;line-height:1;position:absolute;visibility:hidden;font-size:1em;",t.appendChild(document.createElement("M")),document.body.appendChild(t),o=t.offsetHeight,document.body.removeChild(t),o},s=function(t,o){return"none"===t?t=1e4:0<=t.indexOf("rem")?t=parseFloat(t)*e():0<=t.indexOf("em")?t=parseFloat(t)*parseFloat(o.css("font-size")):0<=t.indexOf("px")?(t=parseFloat(t))<=60&&(t/=parseFloat(o.parent().css("width"))):0<=t.indexOf("%")&&(t=parseFloat(t)/100),t},k.fn.bindScrollHandler=function(){return y.preventPageScroll&&k(this).on("DOMMouseScroll mousewheel",function(t){var o,e,n,i,a,r,s,l;if(s=(e=k(this)).scrollTop(),r=e[0].scrollHeight,i=parseInt(e.css("height")),o=e.closest(".bigfoot-footnote"),0<e.scrollTop()&&e.scrollTop()<10&&o.addClass("is-scrollable"),o.hasClass("is-scrollable"))return a=function(){return t.stopPropagation(),t.preventDefault(),t.returnValue=!1},!(l=0<(n="DOMMouseScroll"===t.type?-40*t.originalEvent.detail:t.originalEvent.wheelDelta))&&r-i-s<-n?(e.scrollTop(r),o.addClass("is-fully-scrolled"),a()):l&&s<n?(e.scrollTop(0),o.removeClass("is-fully-scrolled"),a()):o.removeClass("is-fully-scrolled")}),k(this)},x=function(t){if(y.deleteOnUnhover&&y.activateOnHover)return setTimeout(function(){if(k(t.target).closest(".bigfoot-footnote, .bigfoot-footnote__button"),k(".bigfoot-footnote__button:hover, .bigfoot-footnote:hover").length<1)return g()},y.hoverDelay)},l=function(t){if(27===t.keyCode)return g()},g=function(t,o){var e,n,i,a;return null==t&&(t=".bigfoot-footnote"),null==o&&(o=y.popoverDeleteDelay),e=k(),i=n=a=void 0,k(t).each(function(){if(i=k(this),a=i.attr("data-footnote-identifier"),!(n=k('.bigfoot-footnote__button[data-footnote-identifier="'+a+'"]')).hasClass("changing"))return e=e.add(n),n.removeClass("is-active is-hover-instantiated is-click-instantiated").addClass("changing"),i.removeClass("is-active").addClass("disapearing"),setTimeout(function(){return i.remove(),delete v[a],n.removeClass("changing")},o)}),e},h=function(t){var h;y.positionContent&&(h=t?t.type:"resize",k(".bigfoot-footnote").each(function(){var t,o,e,n,i,a,r,s,l,f,c,d,u,p,g;if(n=(e=k(this)).attr("data-footnote-identifier"),e.find(".bigfoot-footnote__content"),t=e.siblings(".bigfoot-footnote__button"),d=m(t),a=parseFloat(e.css("margin-top")),r=+e.attr("data-bigfoot-max-height"),u=2*a+e.outerHeight(),s=1e4,c=d.bottomRoom<u&&d.topRoom>d.bottomRoom,i=v[n],c?("top"!==i&&(v[n]="top",e.addClass("is-positioned-top").removeClass("is-positioned-bottom"),e.css("transform-origin",100*d.leftRelative+"% 100%")),s=d.topRoom-a-15):("bottom"===i&&"init"!==i||(v[n]="bottom",e.removeClass("is-positioned-top").addClass("is-positioned-bottom"),e.css("transform-origin",100*d.leftRelative+"% 0%")),s=d.bottomRoom-a-15),e.find(".bigfoot-footnote__content").css({"max-height":Math.min(s,r)+"px"}),"resize"===h&&(f=parseFloat(e.attr("bigfoot-max-width")),o=e.find(".bigfoot-footnote__wrapper"),(l=f)<=1&&(g=1e4,y.maxWidthRelativeTo&&0<(p=k(y.maxWidthRelativeTo)).length&&(g=p.outerWidth()),l=Math.min(window.innerWidth,g)*f),l=Math.min(l,e.find(".bigfoot-footnote__content").outerWidth()+1),o.css("max-width",l+"px"),e.css({left:-d.leftRelative*l+parseFloat(t.css("margin-left"))+t.outerWidth()/2+"px"}),b(e,d.leftRelative)),parseInt(e.outerHeight())<e.find(".bigfoot-footnote__content")[0].scrollHeight)return e.addClass("is-scrollable")}))},b=function(t,o){var e;null==o&&(o=.5),0<(e=t.find(".bigfoot-footnote__tooltip")).length&&e.css("left",100*o+"%")},m=function(t){var o,e,n,i,a,r;return e=parseFloat(t.css("margin-left")),n=parseFloat(t.outerWidth())-e,o=parseFloat(t.outerHeight()),r=N(),a=t.offset().top-r.scrollY+o/2,i=t.offset().left-r.scrollX+n/2,{topRoom:a,bottomRoom:r.height-a,leftRoom:i,rightRoom:r.width-i,leftRelative:i/r.width,topRelative:a/r.height}},N=function(){var t;return t=k(window),{width:window.innerWidth,height:window.innerHeight,scrollX:t.scrollLeft(),scrollY:t.scrollTop()}},o=function(t,o,e,n,i){var a,r,s,l,f,c;return null==n&&(n=y.popoverDeleteDelay),null==i&&(i=!0),c=r=l=void 0,"string"==typeof t?(f=(r=">"===(c="iphone"===t.toLowerCase()?"<320px":"ipad"===t.toLowerCase()?"<768px":t).charAt(0)?"min":"<"===c.charAt(0)?"max":null)?"("+r+"-width: "+c.substring(1)+")":c,l=window.matchMedia(f)):l=t,l.media&&"invalid"===l.media?{added:!1,mq:l,listener:null}:(a="max"===r,o=o||u(i,n,"min"===r,function(t){return t.addClass("is-bottom-fixed")}),e=e||u(i,n,a,function(){}),s=function(t){t.matches?o(i,d):e(i,d)},l.addListener(s),s(l),y.breakpoints[t]={added:!0,mq:l,listener:s},y.breakpoints[t])},u=function(t,n,i,a){return function(t,o){var e;return e=void 0,t&&(e=o.close(),o.updateSetting("activateCallback",a)),setTimeout(function(){if(o.updateSetting("positionContent",i),t)return o.activate(e)},n)}},p=function(t,o){var e,n,i;if(e=void 0,i=!1,"string"==typeof t)i=y.breakpoints[t]!==undefined;else for(e in y.breakpoints)y.breakpoints.hasOwnProperty(e)&&y.breakpoints[e].mq===t&&(i=!0);return i&&(n=y.breakpoints[e||t],o?o({matches:!1}):n.listener({matches:!1}),n.mq.removeListener(n.listener),delete y.breakpoints[e||t]),i},F=function(t,o){var e,n;if(e=void 0,"string"==typeof t)e=y[t],y[t]=o;else for(n in e={},t)t.hasOwnProperty(n)&&(e[n]=y[n],y[n]=t[n]);return e},c=function(t){return y[t]},k(document).ready(function(){return f(),k(document).on("mouseenter",".bigfoot-footnote__button",n),k(document).on("touchend click",w),k(document).on("mouseout",".is-hover-instantiated",x),k(document).on("keyup",l),k(window).on("scroll resize",h),k(document).on("gestureend",function(){return h()})}),d={removePopovers:g,close:g,createPopover:a,activate:a,repositionFeet:h,reposition:h,addBreakpoint:o,removeBreakpoint:p,getSetting:c,updateSetting:F}}}).call(this);